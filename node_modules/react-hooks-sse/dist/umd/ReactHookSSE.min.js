!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],r):r((e="undefined"!=typeof globalThis?globalThis:e||self).ReactHookSSE={},e.React)}(this,(function(e,r){"use strict";function t(e){if(e&&e.__esModule)return e;var r=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}})),r.default=e,Object.freeze(r)}var n=t(r);function o(e,r){if(null==e)return{};var t,n,o=function(e,r){if(null==e)return{};var t,n,o={},u=Object.keys(e);for(n=0;n<u.length;n++)t=u[n],r.indexOf(t)>=0||(o[t]=e[t]);return o}(e,r);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(n=0;n<u.length;n++)t=u[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}function u(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,u=[],i=!0,a=!1;try{for(t=t.call(e);!(i=(n=t.next()).done)&&(u.push(n.value),!r||u.length!==r);i=!0);}catch(e){a=!0,o=e}finally{try{i||null==t.return||t.return()}finally{if(a)throw o}}return u}(e,r)||function(e,r){if(!e)return;if("string"==typeof e)return i(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return i(e,r)}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var a=["children"],c=n.createContext(null),s=c.Consumer;e.SSEConsumer=s,e.SSEContext=c,e.SSEProvider=function(e){var r=e.children,t=o(e,a),i=u(n.useState((function(){return e="source"in t?t.source:(n=t.endpoint,function(){return new window.EventSource(n)}),r={source:null,listenersByName:new Map},{addEventListener:function(t,n){if(r.listenersByName.size||(r.source=e()),!r.source)throw new Error("The source doesn't exist");var o=r.listenersByName.get(t)||new Set;o.add(n),r.listenersByName.set(t,o),r.source.addEventListener(t,n)},removeEventListener:function(e,t){if(!r.source)throw new Error("The source doesn't exist");var n=r.listenersByName.get(e)||new Set;n.delete(t),n.size||r.listenersByName.delete(e),r.source.removeEventListener(e,t),r.listenersByName.size||(r.source.close(),r.source=null)}};var e,r,n})),1)[0];return n.createElement(c.Provider,{value:i},r)},e.useSSE=function(e,t,n){var o=n||{},i=o.stateReducer,a=void 0===i?function(e,r){return r.data}:i,s=o.parser,l=void 0===s?function(e){return JSON.parse(e)}:s,f=o.context,d=void 0===f?c:f,v=r.useContext(d),y=u(r.useReducer(a,t),2),p=y[0],m=y[1];if(!v)throw new Error("Could not find an SSE context; You have to wrap useSSE() in a <SSEProvider>.");return r.useEffect((function(){var r=function(e){var r=l(e.data);m({event:e,data:r})};return v.addEventListener(e,r),function(){v.removeEventListener(e,r)}}),[]),p},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ReactHookSSE.min.js.map
